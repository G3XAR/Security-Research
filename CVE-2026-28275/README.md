# CVE-2026-28274: Improper JWT Token Invalidation

| Property | Details |
| :--- | :--- |
| **Service** | Initiative |
| **CVSS Score** | 8.1 (High) |
| **Published** | February 26, 2026 |
| **Affected** | `< 0.32.4` |
| **Patched** | `0.32.4` |


## Technical Summary

The application does not invalidate previously issued JWT access tokens after a user changes their password. As a result, older tokens remain valid until expiration and can still be used to access protected API endpoints. This behavior allows continued authenticated access even after the account password has been updated.

During testing it was observed that:

- JWT access tokens remain valid until their exp value.
- Tokens are not invalidated upon logout.
- Tokens are not invalidated after password change.
- No observable revocation mechanism (e.g., blacklist, jti tracking, token versioning) is enforced.

After changing the account password and logging out, previously issued tokens were still accepted by the backend and allowed access to authenticated endpoints.


### Proof of Concept


1. Authenticate and obtain JWT(1).
2. Change the account password.
3. Log out and log back in (JWT2 issued).
4. Use JWT(1) in a requests.
5. The server returns valid user data. JWT remains usable despite the password change.

```bash
# Example 1
curl -i -s -X GET "http://localhost:8173/api/v1/users/" \
     -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyIiwiZXhwIjoxNzcyNTg0OTgyfQ.9DDk4jJRU1QEYG78rJyVi2lvHA6kIO_NhzPltglrmgA"
```

```bash
# Example 2
curl -i -s -X GET "http://localhost:8173/api/v1/guilds/" \
     -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyIiwiZXhwIjoxNzcyNTg0OTgyfQ.9DDk4jJRU1QEYG78rJyVi2lvHA6kIO_NhzPltglrmgA" 
```



https://github.com/user-attachments/assets/de377797-b28f-4b05-a4b0-6470abab5bd7



## Impact

If an attacker gains access to a valid JWT (e.g., via XSS, shared device, leaked logs, browser compromise, or network exposure), they can retain access to the account even after the user changes their password.

This results in:

- Persistent session hijacking
- Continued unauthorized access
- Inability for users to effectively revoke compromised sessions
- Password change does not terminate active sessions, which violates common security expectations and best practices.

Together, these factors increase the risk of prolonged account compromise.

## Mitigation

- Invalidate sessions on password change
- Implement server-side session termination
- Provide global logout functionality
- Limit session lifetime
- Use short-lived access tokens
- Implement token revocation mechanisms
- Implement refresh token rotation
- Invalidate tokens on credential changes

Mitigation 1: [OWASP Session Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)  
Mitigation 2: [JSON Web Token (JWT) Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html)


## Reference

[Official Security Advisory](https://github.com/Morelitea/initiative/security/advisories/GHSA-hww6-3fww-xw3h)

---
